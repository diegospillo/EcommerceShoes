{% extends 'base.html' %}
{% block title %}{{ prodotto.nome }}{% endblock %}
{% block content %}
<h1>{{ prodotto.nome }} {{ prodotto.modello }}</h1>
<p>Marca: {{ prodotto.marca }}</p>
<p>Categoria: {{ prodotto.categoria }}</p>
<p>Prezzo: €{{ '%.2f'|format(prodotto.prezzo) }}</p>
{% for img in prodotto.immagini %}
<img src="{{ img.url }}" alt="{{ prodotto.nome }}" width="200">
{% endfor %}
<form method="post" action="{{ url_for('main.cart_add', prod_id=prodotto.id) }}">
    <label>Taglia:
        <select name="taglia">
            {% for t in prodotto.taglie %}
            <option value="{{ t.taglia }}">{{ t.taglia }}</option>
            {% endfor %}
        </select>
    </label>
    <label>Quantità:<input type="number" name="quantita" value="1"></label>
    <button type="submit">Aggiungi al carrello</button>
</form>

<h2>Recensioni</h2>
<ul>
{% for r in prodotto.recensioni %}
    <li>{{ r.voto }}/5 - {{ r.commento }}</li>
{% endfor %}
</ul>
{% if session.get('user_id') %}
<form method="post" action="{{ url_for('main.add_review', prod_id=prodotto.id) }}">
    <label>Voto:<input type="number" name="voto" min="1" max="5" required></label>
    <label>Commento:<br><textarea name="commento"></textarea></label>
    <button type="submit">Invia</button>
</form>
{% else %}
<p><a href="{{ url_for('main.login') }}">Effettua il login</a> per lasciare una recensione.</p>
{% endif %}
{% endblock %}
